{% if request.user.role == 'ADMIN' %}
<div class="table-responsive p-0">
    <table class="table table-striped align-items-center mb-3 jumps_table">
        <thead class="table-dark">
            <tr>
                <th><strong>Fecha</strong></th>
                <th><strong>Salto</strong></th>
                <th><strong>Izquierda</strong></th>
                <th><strong>Derecha</strong></th>
                <th><strong>Déficit</strong></th>
                <th></th>
            </tr>
        </thead>

        <tbody>
            {% for bilateral in bilaterals %}
                <tr>
                    <td>{{ bilateral.date }}</td>            
                    <td>{% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#biUpdateModal_{{ bilateral.id }}">{{ bilateral.jump }}</a>{% else %}{{ bilateral.jump }}{% endif %}</td>            
                    <td>{% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#biUpdateModal_{{ bilateral.id }}">{{ bilateral.left }}</a>{% else %}{{ bilateral.left }}{% endif %}</td>            
                    <td>{% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#biUpdateModal_{{ bilateral.id }}">{{ bilateral.right }}</a>{% else %}{{ bilateral.right }}{% endif %}</td>            
                    <td>{% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#biUpdateModal_{{ bilateral.id }}">{{ bilateral.deficit }}</a>{% else %}{{ bilateral.deficit }}{% endif %}</td>     
                    <td>
                        {% include './bilateral_update_modal.html' with bilateral=bilateral %}
                        {% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#biUpdateModal_{{ bilateral.id }}"><i class="fs-6 material-icons">edit</i></a>{% endif %}
                    
                        {% include './bilateral_delete_modal.html' with jump=bilateral user=user %}
                        {% if request.user.role == 'ADMIN' %}<a href="#" class="badge rounded-circle" data-bs-toggle="modal" data-bs-target="#bilateralDeleteModal_{{ bilateral.id }}"><i class="fs-6 material-icons">delete</i></a>{% endif %}
                    </td>       
                </tr>
            {% endfor %}
        </tbody>
    </table>

    
    {% if request.user.role == 'ADMIN' %}<a href="#" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#biCreateModal">Agregar Métrica<i class="fs-6 material-icons">add</i></a>{% endif %}
    {% include './bilateral_create_modal.html' %}
</div>
{% endif %}

<div class="notes">
    <h4>Observaciones</h4>
    {% if request.user.role == 'ADMIN' and not bilateral_observation %}<a href="#" class="btn btn-secundary" data-bs-toggle="modal" data-bs-target="#bilateral_create_observation_modal">Agregar Observación<i class="fs-6 material-icons">add</i></a>{% endif %}
    {% include './bilateral_create_observation_modal.html' with user=user %}

    {% if bilateral_observation %}
    <p class="ml-2">{{bilateral_observation.observation}}</p>

    {% if request.user.role == 'ADMIN' %}
        <a href="#" class="btn btn-secundary" data-bs-toggle="modal" data-bs-target="#bilateral_observations_edit_modal">Editar Observación<i class="fs-6 ml-2 material-icons">edit</i></a>
        <a href="#" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#bilateral_observations_delete_modal">Borrar Observación<i class="fs-6 ml-2 material-icons">delete</i></a>
    {% endif %}

    {% include './bilateral_observation_edit_modal.html' with user=user observation=bilateral_observation %}
    {% include './bilateral_observation_delete_modal.html' with user=user observation=bilateral_observation %}
    {% endif %}
</div>

<hr>

{% comment %} {{ df|safe }} {% endcomment %}
{% if graph %}
<div class="mt-4" style="width: 400px">
    <form action="{% url 'users:bilateral_detail' user.id %}" method="get">
        {% csrf_token %}
        <div class="row">
            <div class="col-sm-6">
                <div class="input-group input-group-outline">
                    <select id="osteo_filter" name="date" id="" class="form-control mr-2">
                        <option value="">Selecciona una fecha</option>
                        {% for bi in bilaterals %}
                            {% ifchanged %}
                            <option value="{{bi.date|date:'Y-m-d'}}">{{bi.date}}</option>
                            {% endifchanged %}
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="col-sm-6">
                <div class="input-group input-group-outline">
                    <button class="btn btn-secondary">Filtrar</button>
                </div>
            </div>
        </div>
    </form>
</div>

<h4 class="mt-3">Fecha: {{ date|date:'j'}} de {{ date|date:'F'}} de {{ date|date:'Y'}}</h4>
<div class="graph_wrapper">
    <div class="loader">
        <span>Cargando Gráfico</span>
        <div class="lds-ripple"><div></div><div></div></div>
    </div>
    <div class="graph_inner">
        {{ graph|safe }}
    </div>
</div>
{% endif %}


{% block extrajs %}
<script type="text/javascript">
     
    $(document).ready(function() {
        $(".jumps_table").fancyTable({
           sortOrder:0,
           pagination: true,
           perPage: 10,
           globalSearch:false,
           searchable:false
           });
                     
    });
</script>
{% endblock %}